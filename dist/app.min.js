"use strict";function Date_Time(e){this.Month=get_month_name_by_abv(e),this.Day=get_date(e),this.Time=get_time(e),this.Year=get_year(e)}function get_time(e){var t=e.match(/\b[0-1][0-9]:[0-5][0-9]\s+[AP]M/g);return"0"==t[0].indexOf(0)?t[0].substr(1):t[0]}function get_month_name_by_abv(e){var t=e.match(/\b[0-3][0-9]\s\w{3}\s\d{4}\b\b/g)[0].substr(3,3);switch(t){case"Jan":t="January";break;case"Feb":t="February";break;case"Mar":t="March";break;case"Apr":t="April";break;case"May":t="May";break;case"Jun":t="June";break;case"Jul":t="July";break;case"Aug":t="August";break;case"Sep":t="September";break;case"Oct":t="October";break;case"Nov":t="November";break;case"Dec":t="December";break;default:t=null}return t}function get_month_name(e){var t=new Array(12);return t[0]="January",t[1]="February",t[2]="March",t[3]="April",t[4]="May",t[5]="June",t[6]="July",t[7]="August",t[8]="September",t[9]="October",t[10]="November",t[11]="December",t[e]}function get_date(e){return e.match(/\b[0-3][0-9]\s\w{3}\s\d{4}\b\b/g)[0].substring(0,2)}function get_year(e){return"This function have not been implemented."}function Weather_Forecast(){this.date={},this.day={},this.high={},this.low={},this.text={}}function Weather_Condition(e,t,r){this.Temperature=e,this.Description_Text=t,this.Description_Pic=r}function Wind(e,t,r){this.Chill=e,this.Direction=t,this.Speed=r}function Units(e,t,r,n){this.Distance_units=e,this.Pressure_units=t,this.Speed_units=r,this.Temperature_units=get_temperature_unit(n)}function get_temperature_unit(e){return"F"===e?"&#8457":e}function ExactLocation(e,t){this.Latitude=e,this.Longitude=t}function Location(e,t,r){this.City=e,this.Region=t,this.Country=r,this.ExactLocation={}}function Weather(e,t){this.Current_Date_Time=new Date_Time(t),this.Forecasts={},this.Card_Pic={},this.Location={},this.Units={},this.Sunrise={},this.Sunset={},this.Wind={},this.Humidity={},this.Pressure={},this.Rising={},this.Visibility={},this.Forecasted_HIGH={},this.Forecasted_LOW={},this.Title=e,this.Condition={},this.Description="",this.Description_HTML="",this.Forecasts=[typeof Weather_Forecast],this.Tag={}}function Drake_opinion_basedon_temperature(e){return Number(e)<40?"You should wear a coat; because it's "+e+" degress right now.":Number(e)<80?"You should wear a jacket; because it's "+e+" degress right now.":"You should wear short; because it's "+e+" degress right now."}function hasAM(e){return null!=e.match(/am/gi)}function hasPM(e){return null!=e.match(/pm/gi)}function time_conversion(e){var t;if(hasAM(e)){var r=(t=e.replace(/am/gi,"").trim()).indexOf(":");12==(n=Number(t.substring(0,r)))&&(n=0),t=n+t.substring(r)}else if(hasPM(e)){var n;r=(t=e.replace(/pm/gi,"").trim()).indexOf(":");12!=(n=Number(t.substring(0,r)))&&(n+=12),t=n+t.substring(r)}return t}function is_V1_greater_Than_v2(e,t){var r,n=e.indexOf(":"),i=t.indexOf(":"),o=Number(e.substring(0,n)),s=Number(t.substring(0,i));if(o==s){var a=Number(e.substring(n+1)),c=Number(t.substring(i+1));a==c?r=!0:c<a?r=!0:a<c&&(r=!1)}else s<o?r=!0:o<s&&(r=!1);return r}function background_color_basedon_SunRise_SunDown(e,t,r){var n;RegExp("/\b[0-1]?[0-9]:[0-5][0-9]s+[AP]M/gi");console.log(e);var i=time_conversion(e);console.log(i),console.log(t);var o=time_conversion(t);console.log(o),console.log(r);var s=time_conversion(r);return console.log(s),is_V1_greater_Than_v2(s,i)&&is_V1_greater_Than_v2(o,s)?(n="rgb(174,203,238)",console.log("yes it has am")):(is_V1_greater_Than_v2(i,s)||is_V1_greater_Than_v2(s,o))&&(n="rgb(45,107,182)",console.log("yes it has pm")),console.log(time_conversion(r)),n}function background_color_basedon_temperature(e){return"white"}function background_color_basedon_season(e){var t;switch(e){case"spring":t="green";break;case"summer":t="blue";break;case"fall":t="orange";break;case"winter":t="white";break;default:return"white"}return t}function background_pic_basedon_season(e){switch(e){case"spring":"green";break;case"summer":"blue";break;case"fall":"orange";break;case"winter":"white";break;default:return"white"}}function ParseWeatherYahoo(e){var t={};return(t=new Weather(e.query.results.channel.item.title,e.query.results.channel.lastBuildDate)).Create_Location(e.query.results.channel.location.city,e.query.results.channel.location.region,e.query.results.channel.location.country),t.Location.add_ExactLocation(e.query.results.channel.item.lat,e.query.results.channel.item.long),t.Create_Astronomy(e.query.results.channel.astronomy.sunrise,e.query.results.channel.astronomy.sunset),t.Create_Wind(e.query.results.channel.wind.chill,e.query.results.channel.wind.direction,e.query.results.channel.wind.speed),t.Create_Units(e.query.results.channel.units.distance,e.query.results.channel.units.pressure,e.query.results.channel.units.speed,e.query.results.channel.units.temperature),t.Create_HIGH_LOW(e.query.results.channel.item.forecast[0].high,e.query.results.channel.item.forecast[0].low),t.Create_Condition(e.query.results.channel.item.condition.temp,e.query.results.channel.item.condition.text,parse_picture(e.query.results.channel.item.description,e.query.results.channel.item.condition.text)),t.Card_Pic=picture_card,t.Create_Atmoshphere(e.query.results.channel.atmosphere.humidity,e.query.results.channel.atmosphere.pressure,e.query.results.channel.atmosphere.rising,e.query.results.channel.atmosphere.visibility),t.Description_HTML=remove_CDATA(e.query.results.channel.item.description),t.Tag=[e.query.results.channel.image.url,e.query.results.channel.image.link],t.Forecasts=[],t.Forecasts.push(e.query.results.channel.item.forecast.map(create_forecast)),t}function create_forecast(e,t,r){var n=new Weather_Forecast;return n.date=e.date,n.day=e.day,n.high=e.high,n.low=e.low,n.text=e.text,n}function remove_CDATA(e){return e=(e=e.replace("<![CDATA[","")).replace("]]>","")}var picture_card;function parse_picture(e,t){var r,n;if(startWith_IMG(e=remove_CDATA(e),"<img")){0,r=e.indexOf(">");var i=(n=(n=e.substring(0,r+1)).replace("<img ",'<img id="id_condition_pic" class="imgcondition"')).toString();picture_card='<div id="id_condition_fig" class="fig">'+i+"<p><span>"+t+"</span></p></div>"}else n="Couldn't find the picture.",console.log(n);return n}function startWith_IMG(e,t){return e.substring(0,4)===t}function Display_Results(e,t){var r,n;console.dir(t);try{r=(r='<p class="date_time_display">#DATE_TIME</p>').replace("#DATE_TIME",t.get_current_weather_timestamp("#MONTH #DATE, #TIME")),r=(r=(r+='<p class="dropmargin" >High: #HIGH - Low: #LOW</p>').replace("#HIGH",t.Forecasted_HIGH)).replace("#LOW",t.Forecasted_LOW),r=(r=(r+='<p class="temperature">#TEMPERATURE<sup><small>#UNIT</small></sup></p>').replace("#TEMPERATURE",t.Condition.Temperature)).replace("#UNIT",t.Units.Temperature_units),r=(r+="#CURRENT_PICTURE_GIF").replace("#CURRENT_PICTURE_GIF",t.Card_Pic),r=(r+='<p class="remMar">Location:</p><hr/><p class="date_time_display">#LOCATION</p>').replace("#LOCATION",t.Location.get_Location()),r=(r+='<p class="opinion"><strong>Drake\'s Thoughts!:</strong>#OPINION</p>').replace("#OPINION",Drake_opinion_basedon_temperature(t.Condition.Temperature)),n=(n="<p>#TITLE</p>").replace("#TITLE",t.Title),n+=t.Description_HTML,n=(n=(n+='<p><a href="#IMGLINK" target="_blank"><img src=#SRC class="test"></a></p>').replace("#SRC",t.Tag[0])).replace("#IMGLINK",t.Tag[1]),set_background_color("bbb",background_color_basedon_SunRise_SunDown(t.Sunrise,t.Sunset,t.Current_Date_Time.Time)),document.getElementById(e[0]).value=t.Location.City+", "+t.Location.Region,document.getElementById(e[1]).innerHTML=r,document.getElementById(e[2]).innerHTML=n,document.getElementById("defaultOpen").click()}catch(e){console.error(e.message)}}function set_background(e,t){document.getElementById(e).style.backgroundColor="rgba(201, 76, 76, 0.3)",document.getElementById("bb").style.backgroundColor="rgba(201, 76, 76, 0.3)"}function set_background_color(e,t){document.getElementById(e).style.backgroundColor=t,document.getElementById("bb").style.backgroundColor=t}function set_background_Pic(e,t){document.getElementById(e).style.backgroundImage="url("+t+")",document.getElementById(e).style.backgroundSize="cover"}function On_Submit(e){var t=document.getElementById(e).value;Api_Call("https://query.yahooapis.com/v1/public/yql?q=select * from weather.forecast where woeid in (select woeid from geo.places(1) where text='#ZIPCODE')&format=json".replace("#ZIPCODE",t))}Date_Time.prototype.get_Formated_timestamp=function(e){var t=e;try{var r=RegExp("#MONTH"),n=RegExp("#TIME"),i=RegExp("#DATE");t=r.test(t)||n.test(t)||i.test(t)?(t=(t=t.replace("#MONTH",this.Month)).replace("#TIME",this.Time)).replace("#DATE",this.Day):(t=(t=(t="#MONTH #DATE, #TIME").replace("#MONTH",this.Month)).replace("#TIME",this.Time)).replace("#DATE",this.Day)}catch(e){t=(t=(t=(t="#MONTH #DATE, #TIME").replace("#MONTH",this.Month)).replace("#TIME",this.Time)).replace("#DATE",this.Day)}return t},Location.prototype.add_ExactLocation=function(e,t){this.ExactLocation=new ExactLocation(e,t)},Location.prototype.get_Location=function(){var e="#CITY, #REGION #COUNTRY";return e=(e=(e=e.replace("#CITY",this.City)).replace("#REGION",this.Region)).replace("#COUNTRY",this.Country)},Weather.prototype.Create_Location=function(e,t,r){this.Location=new Location(e,t,r)},Weather.prototype.Create_Condition=function(e,t,r){this.Condition=new Weather_Condition(e,t,r)},Weather.prototype.Create_HIGH_LOW=function(e,t){this.Forecasted_HIGH=e,this.Forecasted_LOW=t},Weather.prototype.Create_Units=function(e,t,r,n){this.Units=new Units(e,t,r,n)},Weather.prototype.Create_Astronomy=function(e,t){this.Sunrise=e,this.Sunset=t},Weather.prototype.Create_Wind=function(e,t,r){this.Wind=new Wind(e,t,r)},Weather.prototype.Create_Atmoshphere=function(e,t,r,n){this.Humidity=e,this.Pressure=t,this.Rising=r,this.Visibility=n},Weather.prototype.get_current_weather_timestamp=function(e){return this.Current_Date_Time.get_Formated_timestamp(e)};var background_Worker,callbackFunction=function(e){var t=JSON.parse(e);0<t.query.count?(console.dir(t),Display_Results(["idZipcode","id_results","id_forecast_results"],ParseWeatherYahoo(t))):document.getElementById("id_results").innerHTML="<h2>Search Found Nothing!</h2>"},callbackFunctionOnError=function(e){console.error(e.message)};function on_enter_pressed(e){e.preventDefault(),13===e.keyCode&&On_Submit(e.target.id)}function reminder(e,t,r,n,i,o){this.body=e,this.icon_pic=t,this.title=r,this.tag=n,this.date_set=i,this.time_set=o}function spawnNotification(e,t,r,n){var i=new Notification(r,{body:e,icon:t,tag:n});setTimeout(i.close.bind(i),5e3)}function On_Notify(e){var t=document.getElementById(e);1==t.checked?notifyMe()||(t.checked=!1):spawnNotification("Notification is now turned off","images/cloud.jpg","Weather API Notification","Weather_API_Started")}function startWorker(){"undefined"!=typeof Worker?(void 0===background_Worker&&(background_Worker=new Worker("JScriptWorker.js")),background_Worker.onmessage=first_run(event)):document.getElementById("result").innerHTML="Sorry! No Web Worker support."}function stopWorker(){background_Worker.terminate(),background_Worker=void 0}function on_SendMessage(){var e=new reminder("Hi","images/cloud.jpg","Checking that Notification works!","Weather_API",Date.now(),"3:00 pm"),t=JSON.stringify(e);background_Worker.postMessage(t),console.log(e),console.log(t)}function first_run(e){document.getElementById("result").innerHTML=e.data}function notifyMe(){var t;return"Notification"in window?"granted"===Notification.permission?(spawnNotification("Notification is now Enabled","images/cloud.jpg","Weather API Notification","Weather_API_Started"),t=!0):"denied"!==Notification.permission?Notification.requestPermission(function(e){"granted"===e?(spawnNotification("Notification is now Enabled to be turned on.","images/cloud.jpg","Weather API Notification","Weather_API_Started"),t=!0):t=!1}):t=!1:(alert("This browser does not support notifications."),t=!1),Notification.requestPermission().then(function(e){console.log(e)}),t}function Api_Call(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState&&200==this.status&&callbackFunction(this.responseText),4==this.readyState&&400<=this.status){var e=this.status;this.abort(),callbackFunctionOnError(new Error("There was an error getting the weather for you. ( status code: "+e+")"))}},t.open("GET",e,!0),t.send()}reminder.prototype.Display_Notification=function(){spawnNotification(this.body,this.icon_pic,this.title,this.tag)};